name: PSScriptAnalyzer

run-name: >
  ${{ github.workflow }}: ${{ github.event_name }} for ${{ github.ref_name }} by @${{ github.actor }}

on:
    push:
        branches:
            - '**'

jobs:
    Analyze:
        runs-on: windows-latest

        steps:
        - name: Checkout repository
          uses: actions/checkout@v4

        - name: Run PSScriptAnalyzer
          shell: pwsh
          run: | 
            $report = Invoke-ScriptAnalyzer -Path . -Recurse -ReportSummary
            $report | Out-String | Set-Content -Path $env:GITHUB_STEP_SUMMARY